<!doctypehtml><title>reddit client</title><meta charset="UTF-8"><meta name="viewport"content="width=device-width,initial-scale=1"><link rel="icon"type="image/x-icon"href="favicon.ico"><style>body{font-family:'Trebuchet MS',sans-serif;background-color:#171717;color:#f7faed}a,a:active,a:visited{color:#fff;text-decoration:none;font-weight:700}.hidden{display:none}.green{background-color:#34d399}.green-text{color:#34d399}.yellow-text{color:#dbca45;font-weight:700}.red-bg{background-color:#f26}.red-text{color:#f26}.light-bg{background-color:#f7faed}.light-text{color:#f7faed}.blue-bg{background-color:#0af}.blue-text{color:#0af}.dark-bg{background-color:#171717}.dark-text{color:#171717}.container{max-width:600px}.top-links{width:100%;text-align:right}.top-links a{color:#f26}ul.posts-container{display:block;list-style:none;margin:0;padding:0}li.post{clear:both;max-width:600px;margin-top:16px;position:relative}img,li.post object{float:left}li.post:hover{cursor:pointer;background-color:#2a2a2a}li.post div.postTextContainer{width:100%;text-align:right;word-wrap:break-word;overflow-wrap:break-word}li.post header{height:80px}li.post footer{height:24px;font-size:12px}li.postCommentsContainer{position:relative;max-width:600px;clear:both;opacity:1}li.postCommentsContainer ul{margin:0;padding:0;list-style:none;font-size:small}li.postCommentsContainer ul li:nth-child(even){color:#878787}li.postCommentsContainer header{height:auto;width:96vw;max-width:600px;display:block;background-color:#373737;text-align:center}li.postCommentsContainer header video{width:100%;max-width:600px}li.postCommentsContainer header img{max-height:1200px;max-width:100%}li.postCommentsContainer .links{display:block;width:100%;font-size:small;background-color:#2a2a2a}li.postCommentsContainer .links a:hover{color:#34d399}li.postCommentsContainer .text{display:block;max-width:600px;word-wrap:break-word}</style><div class="container"><div class="title"><a href="index.html"><h1 class="blue-text"><span style="font-size:80px">&#127751;</span> reddit client</h1></a><small><a href="https://github.com/neuthral/reddit-single-page">https://github.com/neuthral/reddit-single-page</a><br>single page reddit client written with vanilla JS + CSS + HTML<br>there are still minor bugs,<br><b>TODO</b> be able to change subreddit, import user conf</small></div><p id="pageLinks"class="top-links"><select id="sub-select"onchange="urlObject.changeSub(this.value)"><option value="funny"selected="selected">r/funny<option value="memes">r/memes<option value="cats">r/cats</select> <small id="urlPath"class="yellow-text"></small> <a id="prevPageLink"href=""class="red-text"><b class="blue-text">[</b>previous page<b class="blue-text">]</b> </a><a id="nextPageLink"href=""><b class="blue-text">[</b>next page<b class="blue-text">]</b></a><ul id="postsListContainer"class="posts-container"></ul><template id="postRowTemplate"><li class="post"onclick="handlePostOpen(this)"><object data=""type="image/jpg"height="96px"width="128px"loading="lazy"><img src=""height="96px"width="128px"loading="lazy"></object><div class="postTextContainer"><header>{title}</header><footer><span class="red-text">{author}</span> <b class="green-text">&#916;</b> <span class="green-text">{ups}</span> <span class="blue-text">{date}</span> <b>&#8865;</b> <span class="light-text">{comments}</span></footer></div></template><template id="postCommentsTemplate"><ul><header><img src=""alt=""srcset=""></header><li class="links"><a href=""target="_blank">url+permalink</a><li><p class="text"></ul></template><template id="postMediaTemplate"><video width="100%"height=""controls autoplay loading="lazy"><source src="${data.media.reddit_video.dash_url}"type="video/mp4"><source src="${data.media.reddit_video.dash_url}"type="video/mp4"><source src="${data.media.reddit_video.fallback_url}"type="video/ogg">Your browser does not support the video tag.</video></template></div><script>let ul=document.querySelector("#postsListContainer"),postTemplate=document.querySelector("#postRowTemplate"),commentsTemplate=document.querySelector("#postCommentsTemplate"),mediaTemplate=document.querySelector("#postMediaTemplate");var visitedPosts=JSON.parse(localStorage.getItem("visited"))||[],loading=!1;function setAttributes(t,e){for(var a in e)t.setAttribute(a,e[a])}var urlObject={domain:"https://www.reddit.com",sub:"/r/funny",path:"/.json",limit:"?limit=100",urlSub(){return this.domain+this.sub+this.path},changeSub(t){fetchPosts(this.domain+"/r/"+t+this.path)}};function makePost(t){var e=postTemplate.content.cloneNode(!0),a=e.querySelector("li"),a=(setAttributes(a,{id:t.data.id,open:"false","data-id":t.data.id,"data-url":t.data.url,"data-text":t.data.selftext,"data-image":t.data.thumbnail}),t.data.is_video&&(setAttributes(a,{"data-media-0":t.data.media.reddit_video.hls_url,"data-media-1":t.data.media.reddit_video.dash_url,"data-media-2":t.data.media.reddit_video.fallback_url,"data-media-width":600<t.data.media.reddit_video.width?600:t.data.secure_media.reddit_video.width}),e.querySelector("object > img").src="https://fakeimg.pl/128x96/383434/909090?text=video&font=museo"),e.querySelector("object").data=t.data.thumbnail,"default"!=t.data.thumbnail&&"self"!=t.data.thumbnail&&"nsfw"!=t.data.thumbnail||(e.querySelector("object > img").src="https://via.placeholder.com/128x96.png?text="+t.data.thumbnail),e.querySelector("header")),o=(a.textContent=t.data.title.substring(0,192),a.textContent+=t.data.is_video?" --- [VIDEO] ":" ",document.createElement("i")),a=(o.classList.add("yellow-text"),o.textContent="r/"+t.data.subreddit,a.appendChild(o),new Date(1e3*t.data.created)),o=e.querySelectorAll("footer > span");return o[0].textContent=t.data.author,o[1].textContent=t.data.ups,o[2].textContent=a.getDate()+"/"+(a.getMonth()+1)+"/"+a.getFullYear(),o[3].textContent=t.data.num_comments,ul.appendChild(e),t.data}function handlePostClose(t){"true"==t.getAttribute("open")&&(t.setAttribute("open","false"),(t=t.querySelector(".postCommentsContainer")).remove(),console.log("removed element",t))}function handlePostOpen(e){var t,a,o;"false"==e.getAttribute("open")?(t=commentsTemplate.content.cloneNode(!0),e.getAttribute("data-media-1")||e.getAttribute("data-media-2")?((a=mediaTemplate.content.cloneNode(!0)).querySelector("video").width=screen.width,(o=a.querySelectorAll("source"))[0].src=e.getAttribute("data-media-0"),o[1].src=e.getAttribute("data-media-1"),o[2].src=e.getAttribute("data-media-2"),t.querySelector("header").appendChild(a)):t.querySelector("img").src=e.getAttribute("data-url"),t.querySelector(".links > a").href=urlObject.domain+e.getAttribute("data-url"),t.querySelector(".links > a").textContent=e.getAttribute("data-url"),t.querySelector(".text").textContent=e.getAttribute("data-text"),setAttributes(e,{open:!0}),["div.postTextContainer","object"].forEach(t=>{setAttributes(e.querySelector(t),{style:"opacity: 0.5;"})}),(o=document.createElement("li")).appendChild(t),o.id=e.id,o.classList.add("postCommentsContainer"),e.insertAdjacentElement("beforeend",o),console.log("created element",o),this.visitedPosts.push(e.id),localStorage.setItem("visited",JSON.stringify(this.visitedPosts))):handlePostClose(e)}function fetchPosts(t){try{return fetch(t).then(t=>{t.json().then(t=>{t.data.children.forEach(async t=>makePost(t)),console.log(t),document.querySelector("#prevPageLink").href=`index.html?count=${t.data.children.length}&before=`+t.data.children[0].data.name,document.querySelector("#nextPageLink").href=`index.html?count=${t.data.children.length}&after=`+t.data.after}).then(loading=!1).then(()=>{var t=document.querySelector("#pageLinks").cloneNode(!0);document.querySelector("#postsListContainer").insertAdjacentElement("afterend",t)}).catch(t=>t)})}catch(t){console.error(t)}}(()=>{var t=new URL(window.location);console.log(t),fetchPosts(urlObject.urlSub()+t.search),document.querySelector("#urlPath").textContent=urlObject.sub+urlObject.path+urlObject.limit+t.search})()</script>