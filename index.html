<!doctypehtml><html lang="en"><title>reddit client</title><meta charset="UTF-8"><meta name="description"content="minimal reddit client in single page html made in vanilla javascript without third party libraries etc."><meta name="viewport"content="width=device-width,initial-scale=1"><link rel="icon"type="image/x-icon"href="favicon.ico"><style>body{font-family:'Trebuchet MS',sans-serif;background-color:#171717;color:#f7faed}a,a:active,a:visited{color:#fff;text-decoration:none;font-weight:700}.hidden{display:none}.green{background-color:#34d399}.green-text{color:#34d399}.yellow-text{color:#dbca45;font-weight:700}.red-bg{background-color:#f26}.red-text{color:#f26}.light-bg{background-color:#f7faed}.light-text{color:#f7faed}.blue-bg{background-color:#0af}.blue-text{color:#0af}.dark-bg{background-color:#171717}.dark-text{color:#171717}.container{max-width:600px;float:left}.top-links{display:block;width:100%;text-align:right;font-size:larger}.top-links a{color:#f26}#urlPath{font-family:'Courier New',Courier,monospace;font-size:larger}ul.posts-container{display:block;list-style:none;margin:0;padding:0}li.post{clear:both;max-width:600px;margin-top:8px;position:relative;padding:2px;border-bottom:2px solid #2a2a2a}img,li.post object{float:left}li.post:hover{cursor:pointer;background-color:#2a2a2a}li.post div.postTextContainer{width:100%;text-align:right;word-wrap:break-word;overflow-wrap:break-word}li.post header{height:80px}li.post footer{height:24px;font-size:12px}li.postCommentsContainer{position:relative;max-width:600px;clear:both;opacity:1}li.postCommentsContainer ul{margin:0;padding:0;list-style:none;font-size:small}li.postCommentsContainer ul li:nth-child(even){color:#878787}li.postCommentsContainer header{height:auto;width:96vw;max-width:600px;display:block;background-color:#373737;text-align:center}li.postCommentsContainer header video{width:100%;max-width:600px}li.postCommentsContainer header img{max-height:1200px;max-width:100%}li.postCommentsContainer .links{display:block;width:100%;font-size:small;background-color:#2a2a2a}li.postCommentsContainer .links a:hover{color:#34d399}li.postCommentsContainer .text{display:block;max-width:600px;word-wrap:break-word}.subs{list-style:none;padding:0;display:block}.subs li{display:inline-block;margin-right:4px;font-size:larger}.subs li:hover{cursor:pointer;color:#f7faed}</style><div class="container"><div style="display:flex;height:96px"><span style="font-size:74px">&#127751;</span> <span style="align-self:flex-end;font-size:60px">reddit client</span></div><ol id="subLinks"class="subs green-text"></ol><p style="display:block;margin-bottom:128px"></p><small id="urlPath"class="yellow-text"></small><ul id="postsListContainer"class="posts-container"></ul><template id="postRowTemplate"><li class="post"onclick="handlePostOpen(this)"><object data=""type="image/jpg"height="96px"width="128px"loading="lazy"title="post"><img src=""height="96px"width="128px"loading="lazy"alt="post"></object><div class="postTextContainer"><header>{title}</header><footer><span class="red-text">{author}</span> <b class="green-text">&#916;</b> <span class="green-text">{ups}</span> <span class="blue-text">{date}</span> <b>&#8865;</b> <span class="light-text">{comments}</span></footer></div></template><template id="postCommentsTemplate"><ul><header><img src=""alt=""srcset=""></header><li class="links"><a href=""target="_blank">url+permalink</a><li><p class="text"></ul></template><template id="postMediaTemplate"><video width="100%"muted controls loading="lazy"><source src="${data.media.reddit_video.dash_url}"type="video/mp4"><source src="${data.media.reddit_video.dash_url}"type="video/mp4"><source src="${data.media.reddit_video.fallback_url}"type="video/ogg">Your browser does not support the video tag.</video></template></div><script>var visitedPosts=JSON.parse(localStorage.getItem("visited"))||[],loading=!1;let urlObject={domain:"https://www.reddit.com",sub:"funny",limit:"limit=100",query:window.location.search,urlSub(){return`${this.domain}/r/${this.sub}/.json?`+this.limit},changeSub(t){return this.sub=t,this.query="",this.domain+`/r/${t}/.json`},setLinks(t){document.querySelector("#urlPath").innerHTML=this.urlSub()}};var subs=["funny","memes","cats","world","linux","BeAmazed","Weird","WTF","PixelArt"];let ul=document.querySelector("#postsListContainer"),postTemplate=document.querySelector("#postRowTemplate"),commentsTemplate=document.querySelector("#postCommentsTemplate"),mediaTemplate=document.querySelector("#postMediaTemplate"),ol=document.querySelector("#subLinks");function setAttributes(t,e){for(var a in e)t.setAttribute(a,e[a])}function fetchPosts(t){try{ul.innerHTML="",loading=!0,fetch(t).then(t=>{t.json().then(t=>{t.data.children.forEach(async t=>makePost(t)),urlObject.setLinks(t)}).then(loading=!1).catch(t=>t)})}catch(t){console.error(t)}}function makePost(t){var e=postTemplate.content.cloneNode(!0),a=e.querySelector("li"),a=(setAttributes(a,{id:t.data.id,open:!1,"data-id":t.data.id,"data-image":t.data.url,"data-url":t.data.permalink,"data-text":t.data.selftext,"data-thumb":t.data.thumbnail}),t.data.is_video&&(setAttributes(a,{"data-media-0":t.data.media.reddit_video.hls_url,"data-media-1":t.data.media.reddit_video.dash_url,"data-media-2":t.data.media.reddit_video.fallback_url,"data-media-width":600<t.data.media.reddit_video.width?600:t.data.secure_media.reddit_video.width}),e.querySelector("object > img").src="https://fakeimg.pl/128x96/383434/909090?text=video&font=museo"),e.querySelector("object").data=t.data.thumbnail,"default"!=t.data.thumbnail&&"self"!=t.data.thumbnail&&"nsfw"!=t.data.thumbnail&&""!=t.data.thumbnail||(e.querySelector("object > img").src="https://fakeimg.pl/128x96/383434/929292?text="+t.data.thumbnail),e.querySelector("header")),d=(a.textContent=t.data.title.substring(0,192),a.textContent+=t.data.is_video?" --- [VIDEO] ":" ",document.createElement("b")),a=(d.classList.add("yellow-text"),d.textContent="r/"+t.data.subreddit,a.appendChild(d),new Date(1e3*t.data.created)),d=e.querySelectorAll("footer > span");return d[0].textContent=t.data.author,d[1].textContent=t.data.ups,d[2].textContent=a.getDate()+"/"+(a.getMonth()+1)+"/"+a.getFullYear(),d[3].textContent=t.data.num_comments,ul.appendChild(e),t.data}function handlePostClose(t){"true"==t.getAttribute("open")&&(t.setAttribute("open","false"),(t=t.querySelector(".postCommentsContainer")).remove(),console.log("removed element",t))}function handlePostOpen(e){if("false"==e.getAttribute("open")){var t,d,i=commentsTemplate.content.cloneNode(!0);e.getAttribute("data-media-1")||e.getAttribute("data-media-2")?((t=mediaTemplate.content.cloneNode(!0)).querySelector("video").width=screen.width,(d=t.querySelectorAll("source"))[0].src=e.getAttribute("data-media-0"),d[1].src=e.getAttribute("data-media-1"),d[2].src=e.getAttribute("data-media-2"),i.querySelector("header").appendChild(t)):i.querySelector("img").src=e.getAttribute("data-image"),i.querySelector(".links > a").href=urlObject.domain+e.getAttribute("data-url"),i.querySelector(".links > a").textContent=e.getAttribute("data-url"),i.querySelector(".text").textContent=e.getAttribute("data-text"),setAttributes(e,{open:!0}),["div.postTextContainer","object"].forEach(t=>{setAttributes(e.querySelector(t),{style:"opacity: 0.5;"})});let a=document.createElement("li");a.appendChild(i),a.id=e.id,a.classList.add("postCommentsContainer"),e.insertAdjacentElement("beforeend",a),console.log(e),fetch(urlObject.domain+e.getAttribute("data-url")+".json?limit=6").then(t=>{t.json().then(t=>{t[1].data.children.slice(1).forEach(async t=>{var e=document.createElement("li");"t1"==t.kind&&(e.textContent="-- "+t.data.body),"more"==t.kind&&(e.textContent="..."),a.querySelector("ul").appendChild(e)})})}),this.visitedPosts.push(e.id),localStorage.setItem("visited",JSON.stringify(this.visitedPosts))}else handlePostClose(e)}subs.forEach(t=>{var e=document.createElement("li");e.textContent=`[ ${t} ]`,e.addEventListener("click",()=>fetchPosts(urlObject.changeSub(t))),ol.appendChild(e)}),fetchPosts(urlObject.urlSub())</script>